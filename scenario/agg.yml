input:
    input.go: |
        package execution

        // goverter:converter
        type Converter interface {
            // goverter:agg ID Address
            ConvertAgg(source []Input1) []Output1
        }
        type Input1 struct {
            ID      int
            Name    string
            Root    string
            Admin   string
            Color   string
            Tax     string
            Phone   string
            Address string
        }
        type Output1 struct {
            ID      int
            Name    string
            Root    string
            Admin   string
            Color   string
            Tax     string
            Phone   string
            Address []string
        }
success:
    - generated/generated.go: |
        package generated

        import execution "github.com/summit-fi/goverter/execution"

        type ConverterImpl struct{}

        func (c *ConverterImpl) ConvertAgg(source []execution.Input1) []execution.Output1 {
            var result []execution.Output1
            m := map[int]execution.Output1{}
            for _, v := range source {
                if _, ok := m[v.ID]; !ok {
                    m[v.ID] = execution.Output1{
                        ID:      v.ID,
                        Name:    v.Name,
                        Root:    v.Root,
                        Admin:   v.Admin,
                        Color:   v.Color,
                        Tax:     v.Tax,
                        Phone:   v.Phone,
                        Address: []string{},
                    }
                }
                if v.Address == "" {
                    continue
                }
                obj := m[v.ID]
                obj.Address = append(obj.Address, v.Address)
                m[v.ID] = obj
            }
            for _, v := range source {
                found, ok := m[v.ID]
                if !ok {
                    continue
                }
                delete(m, v.ID)
                result = append(result, found)
            }
            return result
        }
